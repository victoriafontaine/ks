jQuery(document).ready(function(a){function b(b,c,d){for(var e=location.search,f=e.substring(1).split("&"),g=0;g<f.length;g++){var h=f[g].split("=");if("post_type"===decodeURIComponent(h[0])&&h[1]&&0!==a(b).length&&!a(b).val())switch(d){case"input":a(b).val(c);break;case"textarea":a(b).append(c);break;default:a(b).val(c)}}}function c(a){var b=a.substr(0,1);return b.toUpperCase()+a.substr(1)}function d(b){a("#post_terms").empty(),a("#tax_plural_label").empty(),a("#post_terms").append("Loading..."),a.post(ajaxurl,{action:"igp_terms",taxonomy:b,nonce:instagrate_pro.nonce},function(b){a("#post_terms").empty(),a("#tax_plural_label").append(b.label),a.each(b.objects,function(b,c){a("#post_terms").append('<input type="checkbox" name="_instagrate_pro_settings[post_term][]" value="'+b+'"/> '+c+"<br />")})},"json")}function e(b){a("label.pending .stat").text("0"),a("label.posted .stat").text("0"),a("label.ignore .stat").text("0"),a("label.posting .stat").text("0"),a("label.moderate .stat").text("0"),a.each(b,function(b,c){a("label."+b+" .stat").text(c.Total),"moderate"===b&&(c.Total>0?a("label."+b+" .stat").parents(".igp-status").removeClass("hide"):a("label."+b+" .stat").parents(".igp-status").addClass("hide"))})}function f(b){a("#igp-images").addClass("processing"),a("#igp-set-bulk-status").attr("disabled","disabled"),a("#igp-set-bulk-status").val("Setting...");var c=a("#post_ID").val(),d=a("#igp-images input:checkbox:checked").map(function(){return this.id}).get().join(",");return""===d?(a("#igp-set-bulk-status").val("Set Status"),a("#igp-set-bulk-status").removeAttr("disabled"),a("#igp-images").removeClass("processing"),alert("No images selected"),!1):(a.post(ajaxurl,{action:"igp_bulk_edit_status",status:b,post_id:c,images:d,nonce:instagrate_pro.nonce},function(c){a("#igp-images input:checkbox:checked").each(function(){a("a[rel^="+this.id+"] img").attr("class",""),a("a[rel^="+this.id+"] img").attr("class",b)}),e(c.stats),a("#igp-images input:checkbox").removeAttr("checked"),a("#toggle_bulk").removeAttr("checked"),a("#igp-set-bulk-status").val("Set Status"),a("#igp-set-bulk-status").removeAttr("disabled"),a("#igp-images").removeClass("processing")},"json"),!1)}function g(b){var c=a(b).val(),d=a("#post_ID").val();return a('input[name="_instagrate_pro_settings[instagram_user]"]').addClass("loading"),a.post(ajaxurl,{action:"igp_get_user_id",post_id:d,username:c,nonce:instagrate_pro.nonce},function(b){a('input[name="_instagrate_pro_settings[instagram_users_id]"]').val(b.users_id),a('input[name="_instagrate_pro_settings[instagram_user]"]').removeClass("loading"),j()},"json"),!1}function h(b){if(""!==a(b).val()){var c=a(b).val(),d=a("#post_ID").val();a('input[name="_instagrate_pro_settings[instagram_location]"]').addClass("loading"),a('select[name="_instagrate_pro_settings[instagram_location_id]"]').empty(),a('select[name="_instagrate_pro_settings[instagram_location_id]"]').append('<option value="">Loading...</option>');var e=new google.maps.Geocoder;e.geocode({address:c},function(b,e){var f=0,g=0;return e===google.maps.GeocoderStatus.OK?(f=b[0].geometry.location.lat(),g=b[0].geometry.location.lng(),a('input[name="_instagrate_pro_settings[location_lat]"]').val(f),a('input[name="_instagrate_pro_settings[location_lng]"]').val(g),a.post(ajaxurl,{action:"igp_get_locations",post_id:d,location:c,lat:f,lng:g,nonce:instagrate_pro.nonce},function(b){a('select[name="_instagrate_pro_settings[instagram_location_id]"]').empty(),a.each(b.locations,function(b,c){a('select[name="_instagrate_pro_settings[instagram_location_id]"]').append('<option value="'+b+'">'+c+"</option>")}),a('input[name="_instagrate_pro_settings[instagram_location]"]').removeClass("loading"),"success"!==b.message&&alert(b.message)},"json"),!1):(alert("Finding the location data was not successful"),a('input[name="_instagrate_pro_settings[instagram_location]"]').removeClass("loading"),a('select[name="_instagrate_pro_settings[instagram_location_id]"]').empty(),a('select[name="_instagrate_pro_settings[instagram_location_id]"]').append('<option value="0">— Enter Location —</option>'),void 0)})}}function i(b){var c=a('select[name="_instagrate_pro_settings[instagram_images]"] option:selected').val();"tagged"===c&&""!==a(b).val()&&(a('input[name="_instagrate_pro_settings[instagram_hashtags]"]').addClass("loading"),j(),a('input[name="_instagrate_pro_settings[instagram_hashtags]"]').removeClass("loading"))}function j(){var b=a("#post_ID").val(),c=a('select[name="_instagrate_pro_settings[instagram_images]"] option:selected').val(),d=a('input[name="_instagrate_pro_settings[instagram_hashtags]"]').val();d=d.replace(/ /g,""),d=d.replace(/#/g,"");var f=d.split(","),g=f[0],h=a('input[name="_instagrate_pro_settings[instagram_users_id]"]').val(),i=a('select[name="_instagrate_pro_settings[instagram_location_id]"]').val();return a("#igp-images").addClass("processing"),a.post(ajaxurl,{action:"igp_change_stream",post_id:b,stream:c,tags:d,tag:g,users_id:h,location_id:i,nonce:instagrate_pro.nonce},function(b){a("#igp-images").empty();var c=0,d=k();a.each(b.images,function(b,e){c++,a("#igp-images").append('<li><a class="edit-image '+e.type+'" rel="'+e.id+'" href="#"><img class="'+d+'" width="70" alt="" src="'+e.images.thumbnail.url+'"><span class="video-ind"></span></a><input id="'+e.id+'" class="igp-bulk" type="checkbox"></li>')}),a('input[name="_instagrate_pro_settings[next_url]"]').val(b.next_url),a('input[name="_instagrate_pro_settings[last_id]"]').val(b.last_id),a("#igp-load-images").show(),(""===b.next_url||null===b.next_url)&&a("#igp-load-images").hide(),a(".igp-bulk").hide(),c>0?(a(".igp-bulk").show(),a(".igp-zero-images").hide(),a("#igp-load-images").show()):(a(".igp-zero-images").show(),a("#igp-load-images").hide()),e(b.stats),a("#igp-images").removeClass("processing")},"json"),!1}function k(){var b="pending";return a('input[name="_instagrate_pro_settings[moderate_images]"]').is(":checked")&&(b="moderate"),b}b("#titlediv #title","%%caption%%"),b("#wp-content-editor-container textarea",'<a href="%%instagram-image-url%%" title="%%caption-no-tags-escaped%%" target="_blank"><img alt="%%caption-no-tags-escaped%%" src="%%image%%" class="%%instagram-media-type%% %%image-class%%"></a>'),a('input[name="_instagrate_pro_settings[post_save_media]"]').is(":checked")&&a(".image-saving").show(),a('input[name="_instagrate_pro_settings[post_save_media]"]').change(function(){a(this).is(":checked")?a(".image-saving").show():a(".image-saving").hide()}),"users"===a('select[name="_instagrate_pro_settings[instagram_images]"] option:selected').val()&&a(".instagram_user").show(),a('select[name="_instagrate_pro_settings[instagram_images]"]').change(function(){"users"===a("option:selected",this).val()?a(".instagram_user").show():a(".instagram_user").hide()}),"location"===a('select[name="_instagrate_pro_settings[instagram_images]"] option:selected').val()&&a(".instagram_location").show(),a('select[name="_instagrate_pro_settings[instagram_images]"]').change(function(){"location"===a("option:selected",this).val()?a(".instagram_location").show():a(".instagram_location").hide()}),"schedule"===a('select[name="_instagrate_pro_settings[posting_frequency]"] option:selected').val()&&a(".schedule").show(),a('select[name="_instagrate_pro_settings[posting_frequency]"]').change(function(){"schedule"===a("option:selected",this).val()?a(".schedule").show():a(".schedule").hide()}),a('select[name="_instagrate_pro_settings[posting_schedule]"]').change(function(){var b=a('select[name="_instagrate_pro_settings[posting_day]"] option').size();"igp_daily"===a("option:selected",this).val()||"igp_twicedaily"===a("option:selected",this).val()||"igp_hourly"===a("option:selected",this).val()?0===a('select[name="_instagrate_pro_settings[posting_day]"] option[value=""]').length&&(a('select[name="_instagrate_pro_settings[posting_day]"]').append(a("<option></option>").attr("value","").text("Daily")),a('select[name="_instagrate_pro_settings[posting_day]"] option:last').attr("selected","selected"),a('select[name="_instagrate_pro_settings[posting_day]"]').attr("disabled","disabled")):8===b&&(a('select[name="_instagrate_pro_settings[posting_day]"]').removeAttr("disabled"),a('select[name="_instagrate_pro_settings[posting_day]"] option:last').remove())}),"manual"===a('select[name="_instagrate_pro_settings[posting_frequency]"] option:selected').val()&&a(".manual").show(),a('select[name="_instagrate_pro_settings[posting_frequency]"]').change(function(){if("manual"===a("option:selected",this).val()){a(".manual").show();var b=a("#post_ID").val();return a.post(ajaxurl,{action:"igp_manual_frequency",post_id:b,nonce:instagrate_pro.nonce},function(a){},"json"),!1}a(".manual").hide()}),a(".grouped").hide(),a(".single_post").hide(),"single"===a('select[name="_instagrate_pro_settings[posting_multiple]"] option:selected').val()&&a(".single_post").show(),"group"===a('select[name="_instagrate_pro_settings[posting_multiple]"] option:selected').val()&&a(".grouped").show(),a('select[name="_instagrate_pro_settings[posting_multiple]"]').change(function(){a(".grouped").hide(),a(".single_post").hide(),"group"===a("option:selected",this).val()&&a(".grouped").show(),"single"===a("option:selected",this).val()&&a(".single_post").show()}),a('select[name="_instagrate_pro_settings[post_type]"]').change(function(){var b=a("option:selected",this).val();a("#select_post_label").html("Select "+c(b)),a('select[name="_instagrate_pro_settings[posting_multiple]"] option[value="each"]').html(c(b)+" Per Image"),a('select[name="_instagrate_pro_settings[posting_multiple]"] option[value="single"]').html("Same "+c(b)),a('select[name="_instagrate_pro_settings[posting_same_post]"]').empty(),a('select[name="_instagrate_pro_settings[posting_same_post]"]').append('<option value="">Loading...</option>'),a.post(ajaxurl,{action:"igp_post_objects",post_type:b,nonce:instagrate_pro.nonce},function(b){a('select[name="_instagrate_pro_settings[posting_same_post]"]').empty(),a.each(b.objects,function(b,c){a('select[name="_instagrate_pro_settings[posting_same_post]"]').append('<option value="'+b+'">'+c+"</option>")})},"json"),a('select[name="_instagrate_pro_settings[post_taxonomy]"]').empty(),a('select[name="_instagrate_pro_settings[post_taxonomy]"]').append('<option value="">Loading...</option>'),a.post(ajaxurl,{action:"igp_taxonomies",post_type:b,nonce:instagrate_pro.nonce},function(b){a('select[name="_instagrate_pro_settings[post_taxonomy]"]').empty(),a.each(b.objects,function(b,c){a('select[name="_instagrate_pro_settings[post_taxonomy]"]').append('<option value="'+b+'">'+c+"</option>")})},"json");var e=a('select[name="_instagrate_pro_settings[post_taxonomy]"] option:selected').val();return d(e),a('select[name="_instagrate_pro_settings[post_tag_taxonomy]"]').empty(),a('select[name="_instagrate_pro_settings[post_tag_taxonomy]"]').append('<option value="">Loading...</option>'),a.post(ajaxurl,{action:"igp_tag_taxonomies",post_type:b,nonce:instagrate_pro.nonce},function(b){a('select[name="_instagrate_pro_settings[post_tag_taxonomy]"]').empty(),a.each(b.objects,function(b,c){a('select[name="_instagrate_pro_settings[post_tag_taxonomy]"]').append('<option value="'+b+'">'+c+"</option>")})},"json"),!1}),a('select[name="_instagrate_pro_settings[post_taxonomy]"]').change(function(){var b=a("option:selected",this).val();return d(b),!1}),a("#igp-logout").on("click",function(b){b.preventDefault();var c=confirm("Disconnect this account from Instagram?");if(c===!0){a("#poststuff").addClass("processing top");var d=a("#post_ID").val();a.post(ajaxurl,{action:"igp_disconnect",post_id:d,nonce:instagrate_pro.nonce},function(a){window.location=a.redirect},"json")}}),a("#igp-refresh").on("click",function(b){b.preventDefault(),document.getElementById("igp-refresh").disabled=!0,a(".igp-avatar").addClass("processing");var c=a("#post_ID").val();a.post(ajaxurl,{action:"igp_refresh",post_id:c,nonce:instagrate_pro.nonce},function(b){a("#user-thumb").attr("src",b.user_thumb),a(".igp-avatar").removeClass("processing"),document.getElementById("igp-refresh").disabled=!1},"json")}),a(".igp-duplicate").on("click",function(){var b=confirm("Are you sure you want to duplicate this account?");if(b===!0){a("#wpbody").addClass("processing");var c=a(this).attr("rel");a.post(ajaxurl,{action:"igp_duplicate_account",post_id:c,nonce:instagrate_pro.nonce},function(a){a.error||(window.location=a.redirect)},"json")}}),a(".igp-sync-likes").on("click",function(){var b=confirm("Are you sure you want to sync likes for this account? This may take some time.");if(b===!0){a("#wpbody").addClass("processing");var c=a(this).attr("rel");a.post(ajaxurl,{action:"igp_sync_likes",post_id:c,nonce:instagrate_pro.nonce},function(a){a.error||(window.location=a.redirect)},"json")}}),a(".igp-sync-comments").on("click",function(){var b=confirm("Are you sure you want to sync comments for this account? This may take some time.");if(b===!0){a("#wpbody").addClass("processing");var c=a(this).attr("rel");a.post(ajaxurl,{action:"igp_sync_comments",post_id:c,nonce:instagrate_pro.nonce},function(a){a.error||(window.location=a.redirect)},"json")}}),a("#igp-load-images").on("click",function(){var b=a("#post_ID").val();a("#igp-images").addClass("processing");var c=a("#igp-images li").length;a("#igp-load-images").attr("disabled","disabled"),a("#igp-load-images").val("Loading..."),a.post(ajaxurl,{action:"igp_load_images",post_id:b,img_count:c,nonce:instagrate_pro.nonce},function(b){var c=k();if(a.each(b.images,function(d,e){a("#igp-images").append('<li><a class="edit-image '+e.media_type+'" rel="'+e.id+'" href="#"><img class="'+(b.load?c:e.status)+'" width="70" alt="" src="'+e.images.thumbnail.url+'"><span class="video-ind"></span></a><input id="'+e.id+'" class="igp-bulk" type="checkbox"></li>')}),b.load){var d="";""===b.next_url||null===b.next_url?a("#igp-load-images").hide():d=b.next_url,a('input[name="_instagrate_pro_settings[next_url]"]').val(d),e(b.stats)}a("#igp-images").removeClass("processing"),a("#igp-load-images").val("Load More"),a("#igp-load-images").removeAttr("disabled")},"json")}),a(".wrap").on("click","#igp-images a.edit-image",function(b){b.preventDefault();var d=a(this),e=a("#post_ID").val();return a("#igp_meta_caption").val(""),a("#igp-edit-image").data("image_id",d.attr("rel")),a("#igp-edit-image").modal(),a("#igp-edit-image strong").addClass("loading"),a.post(ajaxurl,{action:"igp_load_meta",id:a("#igp-edit-image").data("image_id"),post_id:e,nonce:instagrate_pro.nonce},function(b){a("#igp_meta_caption").val(b.meta.caption_clean_no_tags),a("#igp_meta_caption_old").val(b.meta.caption_clean_no_tags),a("#igp_meta_caption_clean_old").val(b.meta.caption_clean),a("#igp_meta_status_old").text(c(b.meta.status)),a("#igp_meta_status_old").addClass(b.meta.status),a("#igp_meta_image").show(),"video"===b.meta.media_type?(a("#jp_container_1").show(),a("#igp-jplayer").jPlayer({ready:function(){a(this).jPlayer("setMedia",{m4v:b.meta.video_url,poster:b.meta.image_url})},swfPath:instagrate_pro.jplayer_path,supplied:"m4v",size:{width:"460px",height:"460px",cssClass:"jp-video-460p"},pause:function(){a(this).next().children(".jp-video-play").show()}}),a("#igp_meta_image").hide()):a("#igp_meta_image").attr("src",b.meta.image_url),a.each(b.meta.tags,function(b,c){a("#igp_meta_hashtags").append('<span class="button">'+c+"</span>")}),a("#igp_meta_image").addClass(b.meta.status),a("#igp-edit-image strong").removeClass("loading")},"json"),!1}),a("#igp_meta_submit").on("click",function(){a("#igp_meta_submit").val("Saving…");var b=a("#post_ID").val(),c=a("#igp-edit-image").data("image_id"),d=a("#igp_meta_status_old").text();return"0"!==a("#igp_meta_status").val()&&(d=a("#igp_meta_status").val()),d=d.toLowerCase(),a.post(ajaxurl,{action:"igp_save_meta",id:c,caption:a("#igp_meta_caption").val(),caption_old:a("#igp_meta_caption_old").val(),caption_clean:a("#igp_meta_caption_clean_old").val(),status:d,post_id:b,nonce:instagrate_pro.nonce},function(b){a("#igp_meta_submit").val("Save Changes"),a("a[rel^="+c+"] img").attr("class",""),a("a[rel^="+c+"] img").attr("class",d),e(b.stats),a.modal.close()},"json"),!1}),a("#igp-set-bulk-status").on("click",function(){var b=a('select[name="igp_bulk_status"] option:selected').val();f(b)}),a(".set-status").on("click",function(){var b=a(this).data("status");f(b)}),a('input[name="_instagrate_pro_settings[moderate_images]"]').change(function(){a("#igp-images").addClass("processing"),a("#igp-set-bulk-status").attr("disabled","disabled");var b="moderate",c="pending";return a(this).is(":checked")&&(b="pending",c="moderate"),a.post(ajaxurl,{action:"igp_bulk_toggle_status",from_status:b,to_status:c,post_id:a("#post_ID").val(),nonce:instagrate_pro.nonce},function(d){e(d.stats),a("#igp-images img."+b).addClass(c),a("#igp-images img").removeClass(b),a("#igp-images").removeClass("processing"),alert(d.message)},"json"),!1}),a('input[name="_instagrate_pro_settings[instagram_user]"]').change(function(){g(this)}),a('input[name="_instagrate_pro_settings[instagram_user]"]').keypress(function(a){return 13===a.which?(a.preventDefault(),g(this),!1):void 0}),a('input[name="_instagrate_pro_settings[instagram_location]"]').change(function(){h(this)}),a('input[name="_instagrate_pro_settings[instagram_location]"]').keypress(function(a){13===a.which&&(a.preventDefault(),h(this))}),a('select[name="_instagrate_pro_settings[instagram_location_id]"]').change(function(){"0"!==a(this).val()&&j()}),a('input[name="_instagrate_pro_settings[instagram_hashtags]"]').change(function(){i(this)}),a('input[name="_instagrate_pro_settings[instagram_hashtags]"]').keypress(function(a){return 13===a.which?(a.preventDefault(),i(this),!1):void 0}),a('select[name="_instagrate_pro_settings[instagram_images]"]').change(function(){var b=(a("#post_ID").val(),a("option:selected",this).val()),c=a('input[name="_instagrate_pro_settings[instagram_hashtags]"]').val();if("tagged"!==b||""!==c){var d=a('input[name="_instagrate_pro_settings[instagram_users_id]"]').val();("users"!==b||""!==d)&&j()}}),a("#igp-manual-post").on("click",function(){var b=a("#post_ID").val(),c=a('select[name="_instagrate_pro_settings[posting_frequency]"] option:selected').val();a("#manual-posting .ig_ajax-loading").show(),a("#igp-images").addClass("processing"),a.post(ajaxurl,{action:"igp_manual_post",post_id:b,frequency:c,nonce:instagrate_pro.nonce},function(b){a("#manual-posting .ig_ajax-loading").hide(),a("a.edit-image img.pending").addClass("ignore"),a("a.edit-image img.ignore").removeClass("pending"),null!==b.images&&a.each(b.images,function(b,c){a("a[rel^="+c.image_id+"] img").attr("class","posted")}),a("#igp-images").removeClass("processing"),e(b.stats),alert(b.message)},"json")}),a("#toggle_bulk").on("click",function(){a(this).is(":checked")?a("#igp-images input[type=checkbox]").attr("checked",!0):a("#igp-images input[type=checkbox]").attr("checked",!1)}),a("#activate-license").on("click",function(){var b=a('input[name="igpsettings_settings[igpsettings_support_license-key]"]').val();""!==b&&(a("#igp_license .spinner").show(),document.getElementById("activate-license").disabled=!0,a.ajax({url:ajaxurl,type:"POST",dataType:"json",data:{action:"igp_activate_license",nonce:instagrate_pro.nonce,license_key:b},success:function(b){b.error?(alert(b.message),a("#igp_license .spinner").hide(),document.getElementById("activate-license").disabled=!1):(a('input[name="igpsettings_settings[igpsettings_support_license-status]"]').val(b.license_status),"activated"===b.license_status?window.location=b.redirect:(alert("License "+b.license_status),a("#igp_license .spinner").hide(),document.getElementById("activate-license").disabled=!1))},error:function(b,c,d){alert("Error: "+d.replace(/(<([^>]+)>)/gi,"")),a("#igp_license .spinner").hide(),document.getElementById("activate-license").disabled=!1}}))}),a("#deactivate-license").on("click",function(){a("#igp_license .spinner").show(),document.getElementById("deactivate-license").disabled=!0,a.ajax({url:ajaxurl,type:"POST",dataType:"json",data:{action:"igp_deactivate_license",nonce:instagrate_pro.nonce},success:function(b){b.error?(alert(b.message),a("#igp_license .spinner").hide(),document.getElementById("deactivate-license").disabled=!1):("deactivated"===b.license_status&&a('input[name="igpsettings_settings[igpsettings_support_license-status]"]').val(""),window.location=b.redirect)},error:function(b,c,d){alert("Error: "+d.replace(/(<([^>]+)>)/gi,"")),a("#igp_license .spinner").hide(),document.getElementById("deactivate-license").disabled=!1}})})});